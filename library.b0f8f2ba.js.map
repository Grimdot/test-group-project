{"mappings":"iiBAAA,IAAAA,EAAAC,EAAA,S,8EAWMC,EAAc,IAAI,E,WAAAC,SAElBC,EAAsB,iEA4BtBC,EAAe,YACnB,EAAAC,EAAAC,gBACA,IAAMC,EAAMC,KAAKC,MAAMC,aAAaC,QAAQ,iBAC5C,IAAKJ,EAGH,OAFAR,EAAAa,KAAKC,QAAQC,mBAAmB,aAAcX,QAC9C,EAAAE,EAAAU,eAIFC,QAAQC,IAAIhB,EAAYiB,kBAAkBX,IAAMY,MAAK,SAAAC,IACnD,EAAAC,EAAAC,eAAcF,IACd,EAAAf,EAAAU,c,KAIEQ,EAAa,YACjB,EAAAlB,EAAAC,gBACA,IAAMC,EAAMC,KAAKC,MAAMC,aAAaC,QAAQ,eAC5C,IAAKJ,EAGH,OAFAR,EAAAa,KAAKC,QAAQC,mBAAmB,aAAcX,QAC9C,EAAAE,EAAAU,eAIFC,QAAQC,IAAIhB,EAAYiB,kBAAkBX,IAAMY,MAAK,SAAAC,IACnD,EAAAC,EAAAC,eAAcF,IACd,EAAAf,EAAAU,c,KAIJQ,IAEAxB,EAAAa,KAAKC,QAAQW,iBAAiB,SA7CH,SAAAC,GACzB,IAAMC,EAASD,EAAEE,OAAOC,WAAWC,QAAQC,GAEtCJ,GAILzB,EAAY8B,cAAcL,GAAQP,MAAK,SAAAC,GACrCY,EAAAC,MAAMC,KAAKF,EAAAG,iBACX,EAAAH,EAAAI,aAAYhB,EAAEiB,K,OAqClBtC,EAAAa,KAAK0B,WAAWd,iBAAiB,SA1DP,SAAAC,GACnBA,EAAEE,OAAOE,UAGgB,eAA1BJ,EAAEE,OAAOE,QAAQU,MACnBnC,IAE4B,aAA1BqB,EAAEE,OAAOE,QAAQU,MACnBhB,I,IAmDJxB,EAAAa,KAAK4B,SAAShB,iBAAiB,QAASiB,EAAAC,gBACxC3C,EAAAa,KAAK+B,UAAUnB,iBAAiB,QAASiB,EAAAG,QAEzC,IAAMC,GAAO,EAAAC,EAAAC,YAEb,EAAAD,EAAAE,oBAAmBH,GAAM,SAAAI,GACnBA,GACFC,QAAQC,IAAI,UAAWF,GACvBG,EAAAC,GAASC,OAAOC,QAAQ,OAAwBC,OAAjBP,EAAKQ,gBAEpCP,QAAQC,IAAI,eACZC,EAAAC,GAASC,OAAOI,KAAM,O","sources":["src/js/library.js"],"sourcesContent":["import { refs } from './refs';\nimport { spinnerStart, spinnerStop } from './spinner';\nimport { lybraryRender } from './render';\nimport { modal, renderModal, afterModalShow } from './modal';\nimport Notiflix from 'notiflix';\n\nimport { authentificate, logOut} from './firebase';\nimport { getAuth, onAuthStateChanged } from 'firebase/auth';\n\nimport moviesAPI from './moviesAPI';\n\nconst filmService = new moviesAPI();\n\nconst emptyStorageMarkup = `<p class = 'storage-error'>This storage is empty... Yet :)</p>`;\nlet uid = null\n\nconst onHeaderBtnsClick = e => {\n  if (!e.target.dataset) {\n    return;\n  }\n  if (e.target.dataset.type === 'watchedBtn') {\n    watchedFetch();\n  }\n  if (e.target.dataset.type === 'queueBtn') {\n    queueFetch();\n  }\n};\n\nconst handleGalleryClick = e => {\n  const filmId = e.target.parentNode.dataset.id;\n\n  if (!filmId) {\n    return;\n  }\n\n  filmService.fetchFilmById(filmId).then(r => {\n    modal.show(afterModalShow);\n    renderModal(r.data);\n  });\n};\n\nconst watchedFetch = () => {\n  spinnerStart();\n  const ids = JSON.parse(localStorage.getItem('watched-list'));\n  if (!ids) {\n    refs.gallery.insertAdjacentHTML('afterbegin', emptyStorageMarkup);\n    spinnerStop();\n    return;\n  }\n\n  Promise.all(filmService.fetcByMultipleIds(ids)).then(r => {\n    lybraryRender(r);\n    spinnerStop();\n  });\n};\n\nconst queueFetch = () => {\n  spinnerStart();\n  const ids = JSON.parse(localStorage.getItem('queue-list'));\n  if (!ids) {\n    refs.gallery.insertAdjacentHTML('afterbegin', emptyStorageMarkup);\n    spinnerStop();\n    return;\n  }\n\n  Promise.all(filmService.fetcByMultipleIds(ids)).then(r => {\n    lybraryRender(r);\n    spinnerStop();\n  });\n};\n\nqueueFetch();\n\nrefs.gallery.addEventListener('click', handleGalleryClick);\nrefs.headerBtns.addEventListener('click', onHeaderBtnsClick);\nrefs.googleIn.addEventListener('click', authentificate);\nrefs.googleOut.addEventListener('click', logOut);\n\nconst auth = getAuth();\n\nonAuthStateChanged(auth, user => {\n  if (user) {\n    console.log('Im here', user);\n    Notiflix.Notify.success(`Hi, ${user.displayName}`)\n  } else {\n    console.log('im not here');\n    Notiflix.Notify.info(`Bye`)\n  }\n});\n\n\n"],"names":["$4Nugj","parcelRequire","$93effc6fc56091ad$var$filmService","default","$93effc6fc56091ad$var$emptyStorageMarkup","$93effc6fc56091ad$var$watchedFetch","$j1lrD","spinnerStart","ids","JSON","parse","localStorage","getItem","refs","gallery","insertAdjacentHTML","spinnerStop","Promise","all","fetcByMultipleIds","then","r","$lF0Zg","lybraryRender","$93effc6fc56091ad$var$queueFetch","addEventListener","e","filmId","target","parentNode","dataset","id","fetchFilmById","$5xtVg","modal","show","afterModalShow","renderModal","data","headerBtns","type","googleIn","$iNWLi","authentificate","googleOut","logOut","$93effc6fc56091ad$var$auth","$gQOBw","getAuth","onAuthStateChanged","user","console","log","$parcel$interopDefault","$iU1Pc","Notify","success","concat","displayName","info"],"version":3,"file":"library.b0f8f2ba.js.map"}